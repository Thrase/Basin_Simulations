using WriteVTK
using Printf

let

    dir = string("../../erickson/output_files/", ARGS[1])
    v_file = open(string(dir, "/vs.dat"))
    u_file = open(string(dir, "/us.dat"))

    @printf "Opened u and v files...\n"

    vs = eachline(v_file)
    us = eachline(v_file)

    @printf "Read u and v data\n..."

    x = map(x->parse(Float64, x), split.(Iterators.take(vs, 1))[1])
    y = map(x->parse(Float64, x), split.(Iterators.take(vs, 2))[1])
    
    count = 1
    @printf "Converting to vtk...\n"
    for line in vs
        @printf "\r%d" count
        vtk = vtk_grid(string(dir, "/vtk_files/cycle", ARGS[2], "_", count, ".vtr"), x, y)
        v = map(x-> parse(Float64, x), split.(line))
        vtk["v"] = v
        saved_files = vtk_save(vtk)
        count += 1
    end
    
    close(v_file)
    close(u_file)

    @printf ("Done.\n")
    
end
